INFO 2025-05-24 17:30:41,457 services Processing document with file_url=https://rag-mna.s3.eu-north-1.amazonaws.com/parsed_jsons/azek_co_inc_2025-03-24.json, deal_id=68184d52478abf06ec1a28ec, embed_data=True
INFO 2025-05-24 17:30:41,597 services Found job in database: Deal: James Hardie Industries PLC/AZEK Co Inc/The (ID: 68184d52478abf06ec1a28ec)
INFO 2025-05-24 17:30:41,598 services Processing file_url: https://rag-mna.s3.eu-north-1.amazonaws.com/parsed_jsons/azek_co_inc_2025-03-24.json
INFO 2025-05-24 17:30:41,713 services Attempting to download from URL: https://rag-mna.s3.eu-north-1.amazonaws.com/parsed_jsons/azek_co_inc_2025-03-24.json
INFO 2025-05-24 17:30:41,713 services Downloading from URL: https://rag-mna.s3.eu-north-1.amazonaws.com/parsed_jsons/azek_co_inc_2025-03-24.json
INFO 2025-05-24 17:30:42,821 services Response status code: 200
INFO 2025-05-24 17:30:42,821 services Response content type: application/json
INFO 2025-05-24 17:30:42,821 services Response content preview: [
  {
    "article": "Article I",
    "title": "THE MERGER",
    "text": "",
    "sections": [
      {
        "section": "1.1",
        "title": "The Merger",
        "text": "Upon the terms and subj
INFO 2025-05-24 17:30:42,823 services Successfully parsed JSON data, type: <class 'list'>
INFO 2025-05-24 17:30:42,825 services Downloaded data type: <class 'list'>
INFO 2025-05-24 17:30:42,828 services File data content sample: [{'article': 'Article I', 'title': 'THE MERGER', 'text': '', 'sections': [{'section': '1.1', 'title': 'The Merger', 'text': 'Upon the terms and subject to the conditions of this Agreement, and in acco
INFO 2025-05-24 17:30:42,828 services Processing file_data as a list
INFO 2025-05-24 17:30:42,829 services Successfully extracted 112 content elements
INFO 2025-05-24 17:30:48,537 services Processing result: {'output_key': 'flatten_json/azek_co_inc_2025-03-24.json', 'flattened_json_url': 'https://rag-mna.s3.amazonaws.com/flatten_json/azek_co_inc_2025-03-24.json'}
INFO 2025-05-24 17:30:48,537 services Storing data for 68184d52478abf06ec1a28ec
WARNING 2025-05-24 17:30:48,540 services ⚠️ Invalid schema_results type: <class 'str'>. Resetting to empty dict.
INFO 2025-05-24 17:30:48,541 services Starting embedding process for job 68184d52478abf06ec1a28ec with URL: https://rag-mna.s3.amazonaws.com/flatten_json/azek_co_inc_2025-03-24.json
INFO 2025-05-24 17:30:48,541 services Submitted embedding task for job 68184d52478abf06ec1a28ec to executor
INFO 2025-05-24 17:30:48,687 services Found job in database: Deal: James Hardie Industries PLC/AZEK Co Inc/The (ID: 68184d52478abf06ec1a28ec)
ERROR 2025-05-24 17:30:48,687 services Error processing embeddings: ValidationError (ProcessingJob:68184d52478abf06ec1a28ec) (Only dictionaries may be used in a DictField: ['schema_results'])
ERROR 2025-05-24 17:30:48,789 services Error updating job status: ValidationError (ProcessingJob:68184d52478abf06ec1a28ec) (Only dictionaries may be used in a DictField: ['schema_results'])
ERROR 2025-05-25 10:08:25,899 views Error fetching deals: 'str' object has no attribute 'items'
ERROR 2025-05-25 10:08:25,904 views Traceback (most recent call last):
  File "/Users/ashishkachhadiya/Documents/rag-djnago/rag_project/document_processor/views.py", line 232, in get
    'deals': serializer.data,
             ^^^^^^^^^^^^^^^
  File "/Users/ashishkachhadiya/Documents/rag-djnago/.venv/lib/python3.12/site-packages/rest_framework/serializers.py", line 768, in data
    ret = super().data
          ^^^^^^^^^^^^
  File "/Users/ashishkachhadiya/Documents/rag-djnago/.venv/lib/python3.12/site-packages/rest_framework/serializers.py", line 253, in data
    self._data = self.to_representation(self.instance)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashishkachhadiya/Documents/rag-djnago/.venv/lib/python3.12/site-packages/rest_framework/serializers.py", line 687, in to_representation
    self.child.to_representation(item) for item in iterable
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashishkachhadiya/Documents/rag-djnago/.venv/lib/python3.12/site-packages/rest_framework/serializers.py", line 522, in to_representation
    ret[field.field_name] = field.to_representation(attribute)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ashishkachhadiya/Documents/rag-djnago/.venv/lib/python3.12/site-packages/rest_framework/fields.py", line 1687, in to_representation
    for key, val in value.items()
                    ^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'items'

